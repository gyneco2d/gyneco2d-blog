---
title: "Discordã®Botã‚’ä½œã‚‹ #1"
slug: "/create-discord-bot-1"
date: 2018-07-24
tags:
  - development
banner: ../common/discord.jpg
---

## Botã®èµ·å‹•

å°‘ã—å‰ï¼Œå­¦å†…ã®ã‚¤ãƒ™ãƒ³ãƒˆã§Rubyã«è§¦ã‚Œã¦ä»¥æ¥ã¡ã‚‡ã£ã¨æ°—ã«å…¥ã£ã¦ã—ã¾ã„ã¾ã—ãŸï¼ãƒ‘ãƒ¼ãƒ¬ãƒ³ã®çœç•¥ã¨ã‹nilã‚¬ãƒ¼ãƒ‰ã¨ã‹ãƒ–ãƒ­ãƒƒã‚¯ã¨ã‹Procã¨ã‹... çœç•¥ã¯ç„¡é—‡ã«è¡Œã†ã¨å¯èª­æ€§ã¨ã‹ã©ã†ãªã®ï¼Œã¨ã‹æ€ã„ã¾ã™ãŒï¼Œãªã‚“ã¨ãªãæ›¸ãå¿ƒåœ°è‰¯ãã¦æ°—ã«å…¥ã‚Šã¾ã—ãŸï¼Botã®ã‚³ãƒ¼ãƒ‰ã§ã¯æ‰‹ç¶šãçš„ãªå‡¦ç†ã§æ¸ˆã‚“ã§ã—ã¾ã£ã¦ã„ã‚‹ã®ã§ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘å…¨ãè§¦ã‚Œã¦ã¾ã›ã‚“ãŒï¼  

ãã‚“ãªæ„Ÿã˜ã§Rubyã§ãªã«ã‹ä½œã‚ã†ã¨æ€ã£ã¦ï¼Œ1å¹´ã»ã©å‰ã«PHPã§ä½œã‚ã†ã¨ã—ã¦æŒ«æŠ˜ã—ãŸDiscordã®Botã‚’ä½œã£ã¦ã¿ã¾ã—ãŸã®ã§è¨˜éŒ²ã—ã¾ã™ï¼  
[gyneco2d/discord-navi](https://github.com/gyneco2d/discord-navi)  

## ãƒ©ã‚¤ãƒ–ãƒ©ãƒª(discordrb)ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
ä»Šå›ã¯ï¼Œ[discordrb](https://github.com/meew0/discordrb)ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦Discord APIã‚’åˆ©ç”¨ã—ã¾ã™ï¼éå…¬å¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ä»–ã«ã‚‚è‰²ã€…ä»¥ä¸‹ã®ãƒšãƒ¼ã‚¸ã«ã¾ã¨ã¾ã£ã¦ãŸã‚Šã—ã¾ã™ï¼  
[Libraries | Unofficial Discord API](https://discordapi.com/unofficial/libs.html)  

Rubyã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯`gem`ã¨ã„ã†å½¢å¼ã§å…¬é–‹ã•ã‚Œã¦ã„ã‚‹ã‚‰ã—ã„ã®ã§  
`$ gem install discordrb`  
ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ï¼MacOSãªã‚‰ã“ã‚Œã§é€šã‚‹ã¨æ€ã„ã¾ã™ã‘ã©ï¼Œã‚µãƒ¼ãƒãªã©ã§ç’°å¢ƒæ§‹ç¯‰ã—ã‚ˆã†ã¨ã™ã‚‹ã¨ï¼Œ  
`ERROR: Failed to build gem native extension.`  
ãªã‚“ã¦ã‚¨ãƒ©ãƒ¼ãŒå‡ºãŸã‚Šã™ã‚‹ï¼ã“ã‚Œã¯å¤§æŠµ`ruby-dev`ã‚„`gcc`ãªã©ã®å„ç¨®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ãªã„ãŸã‚ã ã£ãŸã‚Šã™ã‚‹ã®ã§é©å½“ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãŠãã¾ã—ã‚‡ï¼  

> ä»Šå›åˆã‚ã¦ã¾ã¨ã‚‚ã«å‹•ãBotã‚’ä½œã£ãŸã®ã§åˆã‚ã¦VPSå¥‘ç´„ã—ã¦ç¨¼åƒã•ã›ãŸã‚“ã§ã™ãŒï¼Œã‚µãƒ¼ãƒå¥‘ç´„ã™ã‚‹ã®ãŒåˆã‚ã¦ã ã£ãŸã‚‚ã®ã§ç’°å¢ƒæ§‹ç¯‰ã«ãã“ãã“æ‰‹é–“å–ã‚Šã¾ã—ãŸï¼`gcc`ã™ã‚‰å…¥ã£ã¦ãªã„ã‚“ã§ã™ã­ï¼Œãã†ã„ãˆã°ï¼  
Ubuntuç­‰ã®`apt-get`ãŒä½¿ãˆã‚‹ç’°å¢ƒã§ã‚ã‚Œã°  
`$ sudo apt-get install build-essential`  
ã§C/C++æ¨™æº–é–‹ç™ºãƒ„ãƒ¼ãƒ«ä¸€å¼: C/C++ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã€Makeç­‰ã®æ¨™æº–é–‹ç™ºãƒ„ãƒ¼ãƒ«ä¸€å¼ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹ã¿ãŸã„ãªã®ã§å–ã‚Šæ•¢ãˆãšæœ€åˆã«å®Ÿè¡Œã—ã¦ãŠãã¨ã„ã„ã‹ã‚‚ï¼

## Botã®ç™»éŒ²
Discordã‚¢ã‚«ã‚¦ãƒ³ãƒˆã«ãƒ­ã‚°ã‚¤ãƒ³ã—ãŸçŠ¶æ…‹ã§Botã®ç™»éŒ²ã‚’ã—ã¾ã™ï¼ã“ã“ã¯Botä½œæˆã®è¨˜äº‹ã§æ•£ã€…ç´¹ä»‹ã•ã‚Œã¦ã„ã‚‹ã®ã§çœã“ã†ã¨æ€ã£ãŸã‚“ã§ã™ãŒï¼Œã¡ã‚‡ã†ã©ã“ã‚Œæ›¸ã„ã¦ã‚‹æœ€ä¸­ã«å°‘ã—UIå¤‰ã‚ã£ã¦ãŸã®ã§ãƒ¡ãƒ¢ã£ã¨ãã¾ã™ï¼  

ã“ã®ãƒšãƒ¼ã‚¸ï¼ˆ[https://discordapp.com/developers/applications/](https://discordapp.com/developers/applications/)ï¼‰ã‹ã‚‰`Create an application`ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦æ–°ã—ãBotã‚’ä½œæˆã—ã¾ã™ï¼  
![](images/applications.png)

ä½œæˆã—ãŸBotã®è©³ç´°ãƒšãƒ¼ã‚¸ã«é·ç§»ã™ã‚‹ã®ã§ï¼ŒNAMEã‚„APP ICONã‚’è¨­å®šã—ãŸã‚Šã—ãªã‹ã£ãŸã‚Šã—ãŸå¾Œ`CLIENT ID`ã‚’æ§ãˆã¨ãã¾ã™ï¼  
![](images/client_id.png)

ç¶šã„ã¦ï¼Œbot userãªã‚‹ã‚‚ã®ã‚’è¿½åŠ ã—ã¾ã™ï¼å·¦ã®ã‚µã‚¤ãƒ‰ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰Botã®é …ç›®ã«é£›ã‚“ã§`Add Bot`ã‚¯ãƒªãƒƒã‚¯ â†’ `Yes, do it!`ã™ã‚‹ï¼  
![](images/bot_user.png)

`Click to Reveal Token`ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å‡ºã¦ãã‚‹`TOKEN`ã‚‚æ§ãˆã¨ãã¾ã™ï¼  
![](images/token.png)

æœ€å¾Œã«`CLIENT ID`ã‚’ç½®ãæ›ãˆãŸä¸‹è¨˜ã®URLã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ï¼Œä»»æ„ã®ã‚®ãƒ«ãƒ‰ã«Botã‚’è¿½åŠ ã§ãã‚‹ï¼  

`https://discordapp.com/oauth2/authorize?client_id=ğŸ”¢ğŸ”¢ğŸ”¢&scope=bot&permissions=0`  
![](images/add_bot_to_server.png)

## Botã®èµ·å‹•
discordrbã®ã‚½ãƒ¼ã‚¹ã«ã¯exampleãŒã¤ã„ã¦ã‚‹ã®ã§å–ã‚Šæ•¢ãˆãšBotã‚’èµ·å‹•ã—ã¦ã¿ã‚‹ï¼  
[meew0/discordrb: Discord API for Ruby](https://github.com/meew0/discordrb)  
ä¸Šè¨˜ãƒªãƒã‚¸ãƒˆãƒªã‹ã‚‰`examples/commands.rb`ã‚’ã²ã£ã±ã£ã¦ãã¦ï¼Œ`B0T.T0KEN.here`ã‚’æ§ãˆã¦ãŠã„ãŸ`TOKEN`ã§ç½®ãæ›ãˆã¦å®Ÿè¡Œã™ã‚‹ï¼  

```bash
$ curl https://raw.githubusercontent.com/meew0/discordrb/master/examples/commands.rb > commands.rb
$ vim commands.rb  # TOKENã‚’ç½®ãæ›ãˆã‚‹
$ ruby commands.rb
Using WSCS version: 0.3.0
[INFO : websocket @ 2018-07-23 17:56:56.327] Discord using gateway protocol version: 6, requested: 6
```

### Botèµ·å‹• ('Ï‰')!!!
![](images/online.png)

`!help`ã¨æ‰“ã¦ã°ä½¿ãˆã‚‹ã‚³ãƒãƒ³ãƒ‰ã‚’ãƒªã‚¹ãƒˆã—ã¦ãã‚Œã‚‹  
![](images/command.png)

æ¬¡ã®è¨˜äº‹ï¼ˆ[Discordã®Botã‚’ä½œã‚‹ #2](/create-discord-bot-2)ï¼‰ã¸ç¶šã  
